<icegrid>
  <application name="SistemaVotacion">

    <replica-group id="QueryGroup">
      <load-balancing type="round-robin"/>
      <object identity="QueryService" type="::VotacionXYZ::queryStation"/>
    </replica-group>

    <replica-group id="RMGroup">
      <load-balancing type="round-robin"/>
      <object identity="RMService" type="::VotacionXYZ::RmReceiver"/>
    </replica-group>


    <replica-group id="DataDistributionGroup">
      <load-balancing type="round-robin"/>
      <object identity="DataDistributor" type="::VotacionXYZ::DataDistribution"/>
    </replica-group>


    <node name="nodo-central">
      <server id="ServidorCentral-1" exe="java" activation="always">
        <option>-jar</option>
        <option>../central/build/libs/central-all.jar</option>
        <adapter name="QueryAdapter" replica-group="QueryGroup" endpoints="tcp"/>
        <adapter name="RMAdapter" replica-group="RMGroup" endpoints="tcp"/>
        <adapter name="DistributionAdapter" replica-group="DataDistributionGroup" endpoints="tcp"/>
      </server>

      <server id="ServidorCentral-2" exe="java" activation="always">
        <option>-jar</option>
        <option>../central/build/libs/central-all.jar</option>
        <adapter name="QueryAdapter" replica-group="QueryGroup" endpoints="tcp"/>
        <adapter name="RMAdapter" replica-group="RMGroup" endpoints="tcp"/>
        <adapter name="DistributionAdapter" replica-group="DataDistributionGroup" endpoints="tcp"/>
      </server>
    </node>

    <node name="nodo-reliable">
      <server id="ReliableServer" exe="java" activation="manual">
        <option>-jar</option>
        <option>../reliable/build/libs/reliable.jar</option>

        <adapter name="RMSenderAdapter" endpoints="tcp" register-process="true">
          <object identity="RMSender" type="::VotacionXYZ::RmSender"/>
        </adapter>
      </server>
    </node>

    <replica-group id="VoteStationGroup">
      <load-balancing type="round-robin"/>
      <object identity="VoteStation" type="::VotacionXYZ::VoteStation"/>
    </replica-group>

    <node name="nodo-estacion">
      <!-- Aquí colocamos N réplicas -->
      <server id="Estacion1" exe="java" activation="manual">
        <option>-jar</option>
        <option>../estacion/build/libs/estacion.jar</option>
        <adapter name="EstacionAdapter" replica-group="VoteStationGroup" endpoints="tcp"/>
      </server>

      <server id="Estacion2" exe="java" activation="manual">
        <option>-jar</option>
        <option>../estacion/build/libs/estacion.jar</option>
        <adapter name="EstacionAdapter" replica-group="VoteStationGroup" endpoints="tcp"/>
      </server>

      <server id="Estacion3" exe="java" activation="manual">
        <option>-jar</option>
        <option>../estacion/build/libs/estacion.jar</option>
        <adapter name="EstacionAdapter" replica-group="VoteStationGroup" endpoints="tcp"/>
      </server>

      <server id="Estacion4" exe="java" activation="manual">
        <option>-jar</option>
        <option>../estacion/build/libs/estacion.jar</option>
        <adapter name="EstacionAdapter" replica-group="VoteStationGroup" endpoints="tcp"/>
      </server>

      <server id="Estacion5" exe="java" activation="manual">
        <option>-jar</option>
        <option>../estacion/build/libs/estacion.jar</option>
        <adapter name="EstacionAdapter" replica-group="VoteStationGroup" endpoints="tcp"/>
      </server>

    </node>
  </application>
</icegrid>